#define _CRT_SECURE_NO_WARNINGS
#include <stdio.h>
#include <windows.h>
#include <locale.h>
#include <string.h>
#include <time.h>
#define SIZE 150

typedef struct string_ {
	char s[SIZE] = { 0 };
}strings;

typedef struct typefrases {
	strings connection[SIZE];
	int cur_con = 0;
	strings danger[SIZE];
	int cur_dan = 0;
	strings hot[SIZE];
	int cur_hot = 0;
	strings cold[SIZE];
	int cur_cold = 0;
	strings nofall[SIZE];
	int cur_nofall = 0;
	strings fall[SIZE];
	int cur_fall = 0;
	strings snow[SIZE];
	int cur_snow = 0;
	strings rain[SIZE];
	int cur_rain = 0;
	strings nowind[SIZE];
	int cur_nowind = 0;
	strings wind[SIZE];
	int cur_wind = 0;
	strings strongwind[SIZE];
	int cur_strong = 0;
	strings lowpressure[SIZE];
	int cur_low = 0;
	strings greeting[SIZE];
	int cur_greet = 0;
	strings place[SIZE];
	int cur_place = 0;
	strings when[SIZE];
	int cur_when = 0;
	strings unions[SIZE];
	int cur_union = 0;
	strings verbs[SIZE];
	int cur_verb = 0;
	strings highpressure[SIZE];
	int cur_high = 0;
}fras;

typedef struct day {
	int date[3] = { 0 };
	int nighttemp[2] = { 0 };
	int daytemp[2] = { 0 };
	int feelstemp[2] = { 0 };
	char fall[20] = { 0 };
	int windspeed[2] = { -1, -1 };
	char windway[20];
	int gust[2] = { -1, -1 };
	int pressure = 0;
	char fact[20] = { 0 };
	char time_of_year[20] = { 0 };
	char month[20] = { 0 };
}weather;

typedef struct rates {
	int coldTempRate = 0; // 5 - death, 4 - bad, 3 - oh, 2 - ok, 1 - nice
	int hotTempRate = 0; // 5 - death, 4 - bad, 3 - oh, 2 - ok, 1 - nice
	int windSpeedRate = 0; // 5 - death, 4 - bad, 3 - oh, 2 - ok, 1 - nice
	int pressureRate; // 0 - low, 1 - ok, 2 - high
} rate;

void makesent(weather days[], rate rates[], int dayscount) {
	int max = 0;
	char maininf[SIZE] = { 0 };
	if (rates[dayscount].coldTempRate > max) {
		max = rates[dayscount].coldTempRate;
		strcpy(maininf, "cold");
	}
	if (rates[dayscount].hotTempRate > max) {
		max = rates[dayscount].hotTempRate;
		strcpy(maininf, "hot");
	}
	if (strcmp(days[dayscount].fall, "нет")) {
		switch (max) {
		case 1: 
		case 2:
			if (strlen(days[dayscount].fact) > 0) {
				if (strcmp(maininf, "cold")) {
					if (rates[dayscount].windSpeedRate <= 2) {

					}
					if (rates[dayscount].windSpeedRate == 3) {

					}
					if (rates[dayscount].windSpeedRate >= 4) {

					}
				}
				if (strcmp(maininf, "hot")) {
					if (rates[dayscount].windSpeedRate <= 2) {

					}
					if (rates[dayscount].windSpeedRate == 3) {

					}
					if (rates[dayscount].windSpeedRate >= 4) {

					}
				}
			}
			else {
				if (strcmp(maininf, "cold")) {
					if (rates[dayscount].windSpeedRate <= 2) {

					}
					if (rates[dayscount].windSpeedRate == 3) {

					}
					if (rates[dayscount].windSpeedRate >= 4) {

					}
				}
				if (strcmp(maininf, "hot")) {
					if (rates[dayscount].windSpeedRate <= 2) {

					}
					if (rates[dayscount].windSpeedRate == 3) {

					}
					if (rates[dayscount].windSpeedRate >= 4) {

					}
				}
			}
			break;
		case 3:
			if (strlen(days[dayscount].fact) > 0) {
				if (strcmp(maininf, "cold")) {
					if (rates[dayscount].windSpeedRate <= 2) {

					}
					if (rates[dayscount].windSpeedRate == 3) {

					}
					if (rates[dayscount].windSpeedRate >= 4) {

					}
				}
				if (strcmp(maininf, "hot")) {
					if (rates[dayscount].windSpeedRate <= 2) {

					}
					if (rates[dayscount].windSpeedRate == 3) {

					}
					if (rates[dayscount].windSpeedRate >= 4) {

					}
				}
			}
			else {
				if (strcmp(maininf, "cold")) {
					if (rates[dayscount].windSpeedRate <= 2) {

					}
					if (rates[dayscount].windSpeedRate == 3) {

					}
					if (rates[dayscount].windSpeedRate >= 4) {

					}
				}
				if (strcmp(maininf, "hot")) {
					if (rates[dayscount].windSpeedRate <= 2) {

					}
					if (rates[dayscount].windSpeedRate == 3) {

					}
					if (rates[dayscount].windSpeedRate >= 4) {

					}
				}
			}
			break;
		case 4: 
		case 5:
			if (strlen(days[dayscount].fact) > 0) {
				if (strcmp(maininf, "cold")) {
					if (rates[dayscount].windSpeedRate <= 2) {

					}
					if (rates[dayscount].windSpeedRate == 3) {

					}
					if (rates[dayscount].windSpeedRate >= 4) {

					}
				}
				if (strcmp(maininf, "hot")) {
					if (rates[dayscount].windSpeedRate <= 2) {

					}
					if (rates[dayscount].windSpeedRate == 3) {

					}
					if (rates[dayscount].windSpeedRate >= 4) {

					}
				}
			}
			else {
				if (strcmp(maininf, "cold")) {
					if (rates[dayscount].windSpeedRate <= 2) {

					}
					if (rates[dayscount].windSpeedRate == 3) {

					}
					if (rates[dayscount].windSpeedRate >= 4) {

					}
				}
				if (strcmp(maininf, "hot")) {
					if (rates[dayscount].windSpeedRate <= 2) {

					}
					if (rates[dayscount].windSpeedRate == 3) {

					}
					if (rates[dayscount].windSpeedRate >= 4) {

					}
				}
			}
			break;
		}
	}
	else {
		switch (max) {
		case 1:
		case 2:
			if (strlen(days[dayscount].fact) > 0) {
				if (strcmp(maininf, "cold")) {
					if (rates[dayscount].windSpeedRate <= 2) {

					}
					if (rates[dayscount].windSpeedRate == 3) {

					}
					if (rates[dayscount].windSpeedRate >= 4) {

					}
				}
				if (strcmp(maininf, "hot")) {
					if (rates[dayscount].windSpeedRate <= 2) {

					}
					if (rates[dayscount].windSpeedRate == 3) {

					}
					if (rates[dayscount].windSpeedRate >= 4) {

					}
				}
			}
			else {
				if (strcmp(maininf, "cold")) {
					if (rates[dayscount].windSpeedRate <= 2) {

					}
					if (rates[dayscount].windSpeedRate == 3) {

					}
					if (rates[dayscount].windSpeedRate >= 4) {

					}
				}
				if (strcmp(maininf, "hot")) {
					if (rates[dayscount].windSpeedRate <= 2) {

					}
					if (rates[dayscount].windSpeedRate == 3) {

					}
					if (rates[dayscount].windSpeedRate >= 4) {

					}
				}
			}
			break;
		case 3:
			if (strlen(days[dayscount].fact) > 0) {
				if (strcmp(maininf, "cold")) {
					if (rates[dayscount].windSpeedRate <= 2) {

					}
					if (rates[dayscount].windSpeedRate == 3) {

					}
					if (rates[dayscount].windSpeedRate >= 4) {

					}
				}
				if (strcmp(maininf, "hot")) {
					if (rates[dayscount].windSpeedRate <= 2) {

					}
					if (rates[dayscount].windSpeedRate == 3) {

					}
					if (rates[dayscount].windSpeedRate >= 4) {

					}
				}
			}
			else {
				if (strcmp(maininf, "cold")) {
					if (rates[dayscount].windSpeedRate <= 2) {

					}
					if (rates[dayscount].windSpeedRate == 3) {

					}
					if (rates[dayscount].windSpeedRate >= 4) {

					}
				}
				if (strcmp(maininf, "hot")) {
					if (rates[dayscount].windSpeedRate <= 2) {

					}
					if (rates[dayscount].windSpeedRate == 3) {

					}
					if (rates[dayscount].windSpeedRate >= 4) {

					}
				}
			}
			break;
		case 4:
		case 5:
			if (strlen(days[dayscount].fact) > 0) {
				if (strcmp(maininf, "cold")) {
					if (rates[dayscount].windSpeedRate <= 2) {

					}
					if (rates[dayscount].windSpeedRate == 3) {

					}
					if (rates[dayscount].windSpeedRate >= 4) {

					}
				}
				if (strcmp(maininf, "hot")) {
					if (rates[dayscount].windSpeedRate <= 2) {

					}
					if (rates[dayscount].windSpeedRate == 3) {

					}
					if (rates[dayscount].windSpeedRate >= 4) {

					}
				}
			}
			else {
				if (strcmp(maininf, "cold")) {
					if (rates[dayscount].windSpeedRate <= 2) {

					}
					if (rates[dayscount].windSpeedRate == 3) {

					}
					if (rates[dayscount].windSpeedRate >= 4) {

					}
				}
				if (strcmp(maininf, "hot")) {
					if (rates[dayscount].windSpeedRate <= 2) {

					}
					if (rates[dayscount].windSpeedRate == 3) {

					}
					if (rates[dayscount].windSpeedRate >= 4) {

					}
				}
			}
			break;
		}
	}
}

int main() {
	setlocale(LC_ALL, "RUS");
	printf("Ща запущю погодь...\n");
	srand(time(NULL));
	weather days[SIZE];
	fras frase;
	rate rates[SIZE];
	int cur = 0, dayscur = 0;
	FILE* input;
	FILE* frases;
	input = fopen("input.txt", "rt");
	frases = fopen("frases.txt", "rt");
	char str[SIZE] = { 0 };
	char c = '0';
	while (c != EOF) {
		fscanf(input, "%d.%d.%d\t%d..%d\t%d..%d\t%d..%d\t%s\t", &days[cur].date[0],
			&days[cur].date[1],
			&days[cur].date[2],
			&days[cur].nighttemp[0],
			&days[cur].nighttemp[1],
			&days[cur].daytemp[0],
			&days[cur].daytemp[1],
			&days[cur].feelstemp[0],
			&days[cur].feelstemp[1],
			&days[cur].fall);
		fscanf(input, "%s", &str);
		if (strlen(str) == 3) {
			sscanf(str, "%d-%d", &days[cur].windspeed[0], &days[cur].windspeed[1]);
		}
		else {
			sscanf(str, "%d", &days[cur].windspeed[0]);
		}
		fscanf(input, "%s", &days[cur].windway);
		fscanf(input, "%s", &str);
		if (strlen(str) == 3) {
			sscanf(str, "%d-%d", &days[cur].gust[0], &days[cur].gust[1]);
		}
		else {
			sscanf(str, "%d", &days[cur].gust[0]);
		}
		fscanf(input, "%d", &days[cur].pressure);
		c = fgetc(input);
		if (c == ' ') {
			fscanf(input, "%s", &days[cur].fact);
			c = fgetc(input);
		}
		switch (days[cur].date[1]) {
		case 1:
			strncat(days[cur].month, "января", SIZE);
			strncat(days[cur].time_of_year, "зима", SIZE);
			break;
		case 2:
			strncat(days[cur].month, "февраля", SIZE);
			strncat(days[cur].time_of_year, "зима", SIZE);
			break;
		case 3:
			strncat(days[cur].month, "марта", SIZE);
			strncat(days[cur].time_of_year, "весна", SIZE);
			break;
		case 4:
			strncat(days[cur].month, "апреля", SIZE);
			strncat(days[cur].time_of_year, "весна", SIZE);
			break;
		case 5:
			strncat(days[cur].month, "мая", SIZE);
			strncat(days[cur].time_of_year, "весна", SIZE);
			break;
		case 6:
			strncat(days[cur].month, "июня", SIZE);
			strncat(days[cur].time_of_year, "лето", SIZE);
			break;
		case 7:
			strncat(days[cur].month, "июля", SIZE);
			strncat(days[cur].time_of_year, "лето", SIZE);
			break;
		case 8:
			strncat(days[cur].month, "августа", SIZE);
			strncat(days[cur].time_of_year, "лето", SIZE);
			break;
		case 9:
			strncat(days[cur].month, "сентября", SIZE);
			strncat(days[cur].time_of_year, "осень", SIZE);
			break;
		case 10:
			strncat(days[cur].month, "октября", SIZE);
			strncat(days[cur].time_of_year, "осень", SIZE);
			break;
		case 11:
			strncat(days[cur].month, "ноября", SIZE);
			strncat(days[cur].time_of_year, "осень", SIZE);
			break;
		case 12:
			strncat(days[cur].month, "декабря", SIZE);
			strncat(days[cur].time_of_year, "зима", SIZE);
			break;
		}
		cur++;
	}
	dayscur = cur;
	cur = 0;
	while (!feof(frases)) {
		fgets(str, SIZE, frases);
		if (strcmp(str, "-connection\n") == 0) {
			fgets(str, SIZE, frases);
			while (strcmp(str, "\n") != 0) {
				str[strlen(str) - 1] = '\0';
				strncat(frase.connection[cur].s, str, SIZE);
				printf("%s\n", frase.connection[cur].s);
				cur++;
				fgets(str, SIZE, frases);
			}
			frase.cur_con = cur;
			cur = 0;
		}
		if (strcmp(str, "-danger\n") == 0) {
			fgets(str, SIZE, frases);
			while (strcmp(str, "\n") != 0) {
				str[strlen(str) - 1] = '\0';
				strncat(frase.danger[cur].s, str, SIZE);
				printf("%s\n", frase.danger[cur].s);
				cur++;
				fgets(str, SIZE, frases);
			}
			frase.cur_dan = cur;
			cur = 0;
		}
		if (strcmp(str, "-hot\n") == 0) {
			fgets(str, SIZE, frases);
			while (strcmp(str, "\n") != 0) {
				str[strlen(str) - 1] = '\0';
				strncat(frase.hot[cur].s, str, SIZE);
				printf("%s\n", frase.hot[cur].s);
				cur++;
				fgets(str, SIZE, frases);
			}
			frase.cur_hot = cur;
			cur = 0;
		}
		if (strcmp(str, "-cold\n") == 0) {
			fgets(str, SIZE, frases);
			while (strcmp(str, "\n") != 0) {
				str[strlen(str) - 1] = '\0';
				strncat(frase.cold[cur].s, str, SIZE);
				printf("%s\n", frase.cold[cur].s);
				cur++;
				fgets(str, SIZE, frases);
			}
			frase.cur_cold = cur;
			cur = 0;
		}
		if (strcmp(str, "-no fall\n") == 0) {
			fgets(str, SIZE, frases);
			while (strcmp(str, "\n") != 0) {
				str[strlen(str) - 1] = '\0';
				strncat(frase.nofall[cur].s, str, SIZE);
				printf("%s\n", frase.nofall[cur].s);
				cur++;
				fgets(str, SIZE, frases);
			}
			frase.cur_nofall = cur;
			cur = 0;
		}
		if (strcmp(str, "-fall\n") == 0) {
			fgets(str, SIZE, frases);
			while (strcmp(str, "\n") != 0) {
				str[strlen(str) - 1] = '\0';
				strncat(frase.fall[cur].s, str, SIZE);
				printf("%s\n", frase.fall[cur].s);
				cur++;
				fgets(str, SIZE, frases);
			}
			frase.cur_fall = cur;
			cur = 0;
		}
		if (strcmp(str, "-snow\n") == 0) {
			fgets(str, SIZE, frases);
			while (strcmp(str, "\n") != 0) {
				str[strlen(str) - 1] = '\0';
				strncat(frase.snow[cur].s, str, SIZE);
				printf("%s\n", frase.snow[cur].s);
				cur++;
				fgets(str, SIZE, frases);
			}
			frase.cur_snow = cur;
			cur = 0;
		}
		if (strcmp(str, "-rain\n") == 0) {
			fgets(str, SIZE, frases);
			while (strcmp(str, "\n") != 0) {
				str[strlen(str) - 1] = '\0';
				strncat(frase.rain[cur].s, str, SIZE);
				printf("%s\n", frase.rain[cur].s);
				cur++;
				fgets(str, SIZE, frases);
			}
			frase.cur_rain = cur;
			cur = 0;
		}
		if (strcmp(str, "-no wind\n") == 0) {
			fgets(str, SIZE, frases);
			while (strcmp(str, "\n") != 0) {
				str[strlen(str) - 1] = '\0';
				strncat(frase.nowind[cur].s, str, SIZE);
				printf("%s\n", frase.nowind[cur].s);
				cur++;
				fgets(str, SIZE, frases);
			}
			frase.cur_nowind = cur;
			cur = 0;
		}
		if (strcmp(str, "-wind\n") == 0) {
			fgets(str, SIZE, frases);
			while (strcmp(str, "\n") != 0) {
				str[strlen(str) - 1] = '\0';
				strncat(frase.wind[cur].s, str, SIZE);
				printf("%s\n", frase.wind[cur].s);
				cur++;
				fgets(str, SIZE, frases);
			}
			frase.cur_wind = cur;
			cur = 0;
		}
		if (strcmp(str, "-strong wind\n") == 0) {
			fgets(str, SIZE, frases);
			while (strcmp(str, "\n") != 0) {
				str[strlen(str) - 1] = '\0';
				strncat(frase.strongwind[cur].s, str, SIZE);
				printf("%s\n", frase.strongwind[cur].s);
				cur++;
				fgets(str, SIZE, frases);
			}
			frase.cur_strong = cur;
			cur = 0;
		}
		if (strcmp(str, "-low pressure\n") == 0) {
			fgets(str, SIZE, frases);
			while (strcmp(str, "\n") != 0) {
				str[strlen(str) - 1] = '\0';
				strncat(frase.lowpressure[cur].s, str, SIZE);
				printf("%s\n", frase.lowpressure[cur].s);
				cur++;
				fgets(str, SIZE, frases);
			}
			frase.cur_low = cur;
			cur = 0;
		}
		if (strcmp(str, "-greeting\n") == 0) {
			fgets(str, SIZE, frases);
			while (strcmp(str, "\n") != 0) {
				str[strlen(str) - 1] = '\0';
				strncat(frase.greeting[cur].s, str, SIZE);
				printf("%s\n", frase.greeting[cur].s);
				cur++;
				fgets(str, SIZE, frases);
			}
			frase.cur_greet = cur;
			cur = 0;
		}
		if (strcmp(str, "-place\n") == 0) {
			fgets(str, SIZE, frases);
			while (strcmp(str, "\n") != 0) {
				str[strlen(str) - 1] = '\0';
				strncat(frase.place[cur].s, str, SIZE);
				printf("%s\n", frase.place[cur].s);
				cur++;
				fgets(str, SIZE, frases);
			}
			frase.cur_place = cur;
			cur = 0;
		}
		if (strcmp(str, "-when\n") == 0) {
			fgets(str, SIZE, frases);
			while (strcmp(str, "\n") != 0) {
				str[strlen(str) - 1] = '\0';
				strncat(frase.when[cur].s, str, SIZE);
				printf("%s\n", frase.when[cur].s);
				cur++;
				fgets(str, SIZE, frases);
			}
			frase.cur_when = cur;
			cur = 0;
		}
		if (strcmp(str, "-unions\n") == 0) {
			fgets(str, SIZE, frases);
			while (strcmp(str, "\n") != 0) {
				str[strlen(str) - 1] = '\0';
				strncat(frase.unions[cur].s, str, SIZE);
				printf("%s\n", frase.unions[cur].s);
				cur++;
				fgets(str, SIZE, frases);
			}
			frase.cur_union = cur;
			cur = 0;
		}
		if (strcmp(str, "-verbs\n") == 0) {
			fgets(str, SIZE, frases);
			while (strcmp(str, "\n") != 0) {
				str[strlen(str) - 1] = '\0';
				strncat(frase.verbs[cur].s, str, SIZE);
				printf("%s\n", frase.unions[cur].s);
				cur++;
				fgets(str, SIZE, frases);
			}
			frase.cur_verb = cur;
			cur = 0;
		}
		if (strcmp(str, "-high pressure\n") == 0) {
			fgets(str, SIZE, frases);
			while (strcmp(str, "\n") != 0 && strcmp(str, frase.highpressure[cur - 1].s) != 0) {
				str[strlen(str) - 1] = '\0';
				strncat(frase.highpressure[cur].s, str, SIZE);
				printf("%s\n", frase.highpressure[cur].s);
				cur++;
				fgets(str, SIZE, frases);
			}
			frase.cur_high = cur;
			cur = 0;
		}
	}
	fclose(input);
	fclose(frases);
	for (int dayCount = 0; dayCount < dayscur; ++dayCount)
	{
		// TEMP RATE
		if (days[dayCount].daytemp[1] >= 30) rates[dayCount].hotTempRate = 5;
		if (days[dayCount].daytemp[1] >= 20 && days[dayCount].daytemp[1] <= 29) rates[dayCount].hotTempRate = 4;
		if (days[dayCount].daytemp[1] >= 10 && days[dayCount].daytemp[1] <= 19) rates[dayCount].hotTempRate = 3;
		if (days[dayCount].daytemp[1] >= 5 && days[dayCount].daytemp[1] <= 9) rates[dayCount].hotTempRate = 2;
		if (days[dayCount].daytemp[1] == 0) rates[dayCount].hotTempRate = 1;

		if (days[dayCount].daytemp[1] <= 30) rates[dayCount].coldTempRate = 5;
		if (days[dayCount].daytemp[1] >= -29 && days[dayCount].daytemp[1] <= -20) rates[dayCount].coldTempRate = 4;
		if (days[dayCount].daytemp[1] >= -19 && days[dayCount].daytemp[1] <= -10) rates[dayCount].coldTempRate = 3;
		if (days[dayCount].daytemp[1] >= -9 && days[dayCount].daytemp[1] <= -5) rates[dayCount].coldTempRate = 2;
		if (days[dayCount].daytemp[1] == 0) rates[dayCount].coldTempRate = 1;

		// WIND RATE
		if (days[dayCount].windspeed[1] >= 33) rates[dayCount].windSpeedRate = 5;
		if (days[dayCount].windspeed[1] <= 32 && days[dayCount].windspeed[1] >= 25) rates[dayCount].windSpeedRate = 4;
		if (days[dayCount].windspeed[1] <= 24 && days[dayCount].windspeed[1] >= 15) rates[dayCount].windSpeedRate = 3;
		if (days[dayCount].windspeed[1] <= 14 && days[dayCount].windspeed[1] >= 6) rates[dayCount].windSpeedRate = 2;
		if (days[dayCount].windspeed[1] <= 5 && days[dayCount].windspeed[1] >= 0) rates[dayCount].windSpeedRate = 1;

		// PRESSURE RATE
		if (days[dayCount].pressure <= 740) rates[dayCount].pressureRate = 0;
		if (days[dayCount].pressure <= 759 && days[dayCount].pressure >= 741) rates[dayCount].pressureRate = 1;
		if (days[dayCount].pressure >= 760) rates[dayCount].pressureRate = 2;
	}
}
