#define _CRT_SECURE_NO_WARNINGS
#include <stdio.h>
#include <windows.h>
#include <locale.h>
#include <string.h>
#define SIZE 50

typedef struct string_ {
	char s[SIZE] = { 0 };
}strings;

typedef struct typefrases {
	strings connection[SIZE];
	strings danger[SIZE];
	strings hot[SIZE];
	strings cold[SIZE];
	strings nofall[SIZE];
	strings fall[SIZE];
	strings snow[SIZE];
	strings rain[SIZE];
	strings nowind[SIZE];
	strings wind[SIZE];
	strings strongwind[SIZE];
	strings lowdav[SIZE];
	strings highdav[SIZE];
}fras;

typedef struct day {
	int date[3] = { 0 };
	int nighttemp[2] = { 0 };
	int daytemp[2] = { 0 };
	int feelstemp[2] = { 0 };
	char osadki[SIZE] = { 0 };
	int windspeed[2] = { -1, -1 };
	char windway[SIZE] = { 0 };
	int poriv[2] = { -1, -1 };
	int pressure = 0;
	char fact[SIZE] = { 0 };
	char time_of_year[SIZE] = { 0 };
	char month[SIZE] = { 0 };
}weather;

int main() {
	setlocale(LC_ALL, "RUS");
	printf("Ща запущю погодь...\n");
	weather days[SIZE];
	fras frase;
	int cur = 0;
	FILE* input;
	FILE* frases;
	input = fopen("input.txt", "rt");
	frases = fopen("frases.txt", "rt");
	char str[SIZE] = { 0 };
	char c='0';
	while (c!=EOF && c!=' ') {
		fscanf(input, "%d.%d.%d\t%d..%d\t%d..%d\t%d..%d\t%s\t", &days[cur].date[0],
			&days[cur].date[1],
			&days[cur].date[2],
			&days[cur].nighttemp[0],
			&days[cur].nighttemp[1],
			&days[cur].daytemp[0],
			&days[cur].daytemp[1],
			&days[cur].feelstemp[0],
			&days[cur].feelstemp[1],
			&days[cur].osadki);
		fscanf(input, "%s", &str);
		if (strlen(str) == 3) {
			sscanf(str, "%d-%d", &days[cur].windspeed[0], &days[cur].windspeed[1]);
		}
		else {
			sscanf(str, "%d", &days[cur].windspeed[0]);
		}
		fscanf(input, "%s", &days[cur].windway);
		fscanf(input, "%s", &str);
		if (strlen(str) == 3) {
			sscanf(str, "%d-%d", &days[cur].poriv[0], &days[cur].poriv[1]);
		}
		else {
			sscanf(str, "%d", &days[cur].poriv[0]);
		}
		fscanf(input, "%d", &days[cur].pressure);
		c = fgetc(input);
		if (c == ' ') {
			fscanf(input, "%s", &days[cur].fact);
		}
		switch (days[cur].date[1]) {
		case 1:
			strncat(days[cur].month, "январь", SIZE);
			strncat(days[cur].time_of_year, "зима", SIZE);
			break;
		case 2:
			strncat(days[cur].month, "февраль", SIZE);
			strncat(days[cur].time_of_year, "зима", SIZE);
			break;
		case 3:
			strncat(days[cur].month, "март", SIZE);
			strncat(days[cur].time_of_year, "весна", SIZE);
			break;
		case 4:
			strncat(days[cur].month, "апрель", SIZE);
			strncat(days[cur].time_of_year, "весна", SIZE);
			break;
		case 5:
			strncat(days[cur].month, "май", SIZE);
			strncat(days[cur].time_of_year, "весна", SIZE);
			break;
		case 6:
			strncat(days[cur].month, "июнь", SIZE);
			strncat(days[cur].time_of_year, "лето", SIZE);
			break;
		case 7:
			strncat(days[cur].month, "июль", SIZE);
			strncat(days[cur].time_of_year, "лето", SIZE);
			break;
		case 8:
			strncat(days[cur].month, "август", SIZE);
			strncat(days[cur].time_of_year, "лето", SIZE);
			break;
		case 9:
			strncat(days[cur].month, "сентябрь", SIZE);
			strncat(days[cur].time_of_year, "осень", SIZE);
			break;
		case 10:
			strncat(days[cur].month, "октябрь", SIZE);
			strncat(days[cur].time_of_year, "осень", SIZE);
			break;
		case 11:
			strncat(days[cur].month, "ноябрь", SIZE);
			strncat(days[cur].time_of_year, "осень", SIZE);
			break;
		case 12:
			strncat(days[cur].month, "декабрь", SIZE);
			strncat(days[cur].time_of_year, "зима", SIZE);
			break;
		}
		cur++;
	}
	c = '0';
	cur = 0;
	while (!feof(frases)) {
		fgets(str, SIZE, frases);
		if (strcmp(str, "-connection\n") == 0) {
			fgets(str, SIZE, frases);
			while (strcmp(str, "\n") != 0) {
				str[strlen(str)-1] = '\0';
				strncat(frase.connection[cur].s, str, SIZE);
				printf("%s\n", frase.connection[cur].s);
				cur++;
				fgets(str, SIZE, frases);
			}
			cur = 0;
		}
		if (strcmp(str, "-danger\n") == 0) {
			fgets(str, SIZE, frases);
			while (strcmp(str, "\n") != 0) {
				str[strlen(str)-1] = '\0';
				strncat(frase.danger[cur].s, str, SIZE);
				printf("%s\n", frase.danger[cur].s);
				cur++;
				fgets(str, SIZE, frases);
			}
			cur = 0;
		}
		if (strcmp(str, "-hot\n") == 0) {
			fgets(str, SIZE, frases);
			while (strcmp(str, "\n") != 0) {
				str[strlen(str)-1] = '\0';
				strncat(frase.hot[cur].s, str, SIZE);
				printf("%s\n", frase.hot[cur].s);
				cur++;
				fgets(str, SIZE, frases);
			}
			cur = 0;
		}
		if (strcmp(str, "-cold\n") == 0) {
			fgets(str, SIZE, frases);
			while (strcmp(str, "\n") != 0) {
				str[strlen(str)-1] = '\0';
				strncat(frase.cold[cur].s, str, SIZE);
				printf("%s\n", frase.cold[cur].s);
				cur++;
				fgets(str, SIZE, frases);
			}
			cur = 0;
		}
		if (strcmp(str, "-no fall\n") == 0) {
			fgets(str, SIZE, frases);
			while (strcmp(str, "\n") != 0) {
				str[strlen(str)-1] = '\0';
				strncat(frase.nofall[cur].s, str, SIZE);
				printf("%s\n", frase.nofall[cur].s);
				cur++;
				fgets(str, SIZE, frases);
			}
			cur = 0;
		}
		if (strcmp(str, "-fall\n") == 0) {
			fgets(str, SIZE, frases);
			while (strcmp(str, "\n") != 0) {
				str[strlen(str)-1] = '\0';
				strncat(frase.fall[cur].s, str, SIZE);
				printf("%s\n", frase.fall[cur].s);
				cur++;
				fgets(str, SIZE, frases);
			}
			cur = 0;
		}
		if (strcmp(str, "-snow\n") == 0) {
			fgets(str, SIZE, frases);
			while (strcmp(str, "\n") != 0) {
				str[strlen(str)-1] = '\0';
				strncat(frase.snow[cur].s, str, SIZE);
				printf("%s\n", frase.snow[cur].s);
				cur++;
				fgets(str, SIZE, frases);
			}
			cur = 0;
		}
		if (strcmp(str, "-rain\n") == 0) {
			fgets(str, SIZE, frases);
			while (strcmp(str, "\n") != 0) {
				str[strlen(str)-1] = '\0';
				strncat(frase.rain[cur].s, str, SIZE);
				printf("%s\n", frase.rain[cur].s);
				cur++;
				fgets(str, SIZE, frases);
			}
			cur = 0;
		}
		if (strcmp(str, "-no wind\n") == 0) {
			fgets(str, SIZE, frases);
			while (strcmp(str, "\n") != 0) {
				str[strlen(str)-1] = '\0';
				strncat(frase.nowind[cur].s, str, SIZE);
				printf("%s\n", frase.nowind[cur].s);
				cur++;
				fgets(str, SIZE, frases);
			}
			cur = 0;
		}
		if (strcmp(str, "-wind\n") == 0) {
			fgets(str, SIZE, frases);
			while (strcmp(str, "\n") != 0) {
				str[strlen(str)-1] = '\0';
				strncat(frase.wind[cur].s, str, SIZE);
				printf("%s\n", frase.wind[cur].s);
				cur++;
				fgets(str, SIZE, frases);
			}
			cur = 0;
		}
		if (strcmp(str, "-strong wind\n") == 0) {
			fgets(str, SIZE, frases);
			while (strcmp(str, "\n") != 0) {
				str[strlen(str)-1] = '\0';
				strncat(frase.strongwind[cur].s, str, SIZE);
				printf("%s\n", frase.strongwind[cur].s);
				cur++;
				fgets(str, SIZE, frases);
			}
			cur = 0;
		}
		if (strcmp(str, "-low dav\n") == 0) {
			fgets(str, SIZE, frases);
			while (strcmp(str, "\n") != 0) {
				str[strlen(str)-1] = '\0';
				strncat(frase.lowdav[cur].s, str, SIZE);
				printf("%s\n", frase.lowdav[cur].s);
				cur++;
				fgets(str, SIZE, frases);
			}
			cur = 0;
		}
		if (strcmp(str, "-high dav\n") == 0) {
			fgets(str, SIZE, frases);
			while (strcmp(str, "\n") != 0 && strcmp(str, frase.highdav[cur-1].s) != 0) {
				str[strlen(str)-1] = '\0';
				strncat(frase.highdav[cur].s, str, SIZE);
				printf("%s\n", frase.highdav[cur].s);
				cur++;
				fgets(str, SIZE, frases);
			}
			cur = 0;
		}
	}
	fclose(input);
	fclose(frases);
}
